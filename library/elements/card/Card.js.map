{"version":3,"sources":["../../../source/javascript/elements/card/Card.js"],"names":[],"mappings":"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","file":"Card.js","sourcesContent":["import React, { Component, PropTypes, } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport KlassName from 'teapan/klassName';\n\nimport Icon from '../icon/Icon';\nimport Button from '../button/Button';\n\nimport CardFront from './CardFront';\nimport CardBack from './CardBack';\n\nclass Card extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {\n\t\t\theight: props.height,\n\t\t\tflipped: props.flipped,\n\t\t};\n\n\t\tthis.handleControlClick = this.handleControlClick.bind(this);\n\t\tthis.handleControlKeyDown = this.handleControlKeyDown.bind(this);\n\t\tthis.handleFrontHeightChange = this.handleFrontHeightChange.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tsyncNodeAttributes(findDOMNode(this), this.props);\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tthis.setState({\n\t\t\theight: nextProps.height,\n\t\t\tflipped: nextProps.flipped,\n\t\t});\n\t}\n\n\tcomponentDidUpdate() {\n\t\tsyncNodeAttributes(findDOMNode(this), this.props);\n\t}\n\n\thandleControlClick(event) {\n\t\tif (!this.props.duplexed) return;\n\n\t\tlet node = event.target;\n\n\t\tdo {\n\t\t\tif (this.isControlNode(node)) {\n\t\t\t\tthis.setFlipped();\n\t\t\t\treturn;\n\t\t\t}\n\t\t} while ((node = node.parentNode) !== null);\n\t}\n\n\thandleControlKeyDown(event) {\n\t\tif (this.isControlNode(event.target)) {\n\t\t\tif (event.keyCode === 13) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tthis.setFlipped();\n\t\t\t}\n\t\t}\n\t}\n\n\thandleFrontHeightChange(newHeight) {\n\t\tthis.setState({\n\t\t\theight: newHeight,\n\t\t});\n\t}\n\n\tsetFlipped() {\n\t\tthis.setState({\n\t\t\tflipped: !this.state.flipped,\n\t\t});\n\n\t\tif (typeof this.props.onFlip === 'function') {\n\t\t\tthis.props.onFlip();\n\t\t}\n\t}\n\n\tisControlNode(node) {\n\t\treturn node.getAttribute('role') === 'control' && node.parentElement.parentElement === (0, findDOMNode)(this);\n\t}\n\n\trenderControl() {\n\t\treturn (\n\t\t\t<div className=\"card-control\">\n\t\t\t\t<Button\n\t\t\t\t\tsize=\"tiny\"\n\t\t\t\t\tkind=\"link\"\n\t\t\t\t\tskin=\"brand\"\n\t\t\t\t\trole=\"control\"\n\t\t\t\t\ttabIndex={-1}\n\t\t\t\t\tonClick={this.handleControlClick}\n\t\t\t\t\tonKeyDown={this.handleControlKeyDown}\n\t\t\t\t>\n\t\t\t\t\t<Icon name=\"repost\" />\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t);\n\t}\n\n\trenderChildren() {\n\t\treturn React.Children.map(this.props.children, (child) => {\n\t\t\tif (child === null) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst duplexed = this.props.duplexed;\n\t\t\tconst flipped = this.state.flipped;\n\t\t\tconst height = this.state.height;\n\t\t\tconst syncHeight = this.handleFrontHeightChange;\n\n\t\t\treturn React.cloneElement(child, {\n\t\t\t\tduplexed,\n\t\t\t\tflipped,\n\t\t\t\theight,\n\t\t\t\tsyncHeight\n\t\t\t});\n\t\t}) ;\n\t}\n\n\trender() {\n\t\tconst props = this.props;\n\t\tconst {\n\t\t\tduplexed,\n\t\t\tclassName,\n\t\t\t...others\n\t\t} = props;\n\n\t\tconst klassName = KlassName(\n\t\t\t'card',\n\t\t\t{\n\t\t\t\t['duplexed']:('duplexed' in props && duplexed !== false),\n\t\t\t},\n\t\t\tclassName\n\t\t);\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\t{...others}\n\t\t\t\tref={(e) => {\n\t\t\t\t\tthis.card = e;\n\t\t\t\t}}\n\t\t\t\tclassName={klassName}\n\t\t\t>\n\t\t\t\t{duplexed ? this.renderControl() : null}\n\t\t\t\t{this.renderChildren()}\n\t\t\t</div>\n\t\t);\n\t}\n};\n\nconst noop = () => {};\n\nfunction syncNodeAttributes(node, props) {\n\tif (props.duplexed) {\n\t\tnode.setAttribute('tabindex', 0);\n\t\tnode.setAttribute('duplexed', 'duplexed');\n\t} else {\n\t\tnode.removeAttribute('tabindex');\n\t\tnode.removeAttribute('duplexed');\n\t}\n};\n\nfunction affirmChildrenPropTypes(props, propName) {\n\tlet error;\n\tlet frontsCount = 0;\n\tlet backsCount = 0;\n\tconst children = props[propName];\n\n\tReact.Children.forEach(children, (child) => {\n\t\tif (child === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (child.type === CardFront) {\n\t\t\tfrontsCount++ ;\n\t\t} else if (child.type === CardBack) {\n\t\t\tbacksCount++ ;\n\t\t} else {\n\t\t\terror = new Error(\n\t\t\t\t'Expected `CardFront` or `CardBack` not found `' + (child.type.displayName || child.type) + '`'\n\t\t\t);\n\t\t}\n\n\t});\n\n\tif (frontsCount != 1) {\n\t\terror = new Error(\n\t\t\t'There should have one `CardFront` component`. '\n\t\t);\n\t}\n\n\treturn error;\n};\n\nCard.propTypes = {\n\tduplexed: PropTypes.bool,\n\tflipped: PropTypes.bool,\n\n\theight: PropTypes.string,\n\tclassName: PropTypes.string,\n\tchildren: affirmChildrenPropTypes,\n\n\tonFlip: PropTypes.func\n};\n\nCard.defaultProps = {\n\tduplexed: false,\n\tflipped: false,\n\tonFlip: noop\n};\n\nexport default Card;"]}