{"version":3,"sources":["../../../source/javascript/elements/textfield/EnhanceTextField.js"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;;;;;;;;;;;AAEA,IAAM,aAAa,EAAb;;IAEA;;;AACL,UADK,gBACL,CAAY,KAAZ,EAAmB;wBADd,kBACc;;qEADd,6BAEE,QADY;;AAElB,QAAK,KAAL,GAAa;AACZ,WAAQ,MAAM,IAAN,GAAa,UAAb;GADT,CAFkB;AAKlB,QAAK,YAAL,GAAoB,MAAK,YAAL,CAAkB,IAAlB,OAApB,CALkB;AAMlB,QAAK,YAAL,GAAoB,MAAK,YAAL,CAAkB,IAAlB,OAApB,CANkB;;EAAnB;;cADK;;sCAUe;AACnB,QAAK,oBAAL,GADmB;;;;4CAIM,WAAW;AACpC,OAAI,UAAU,KAAV,KAAoB,KAAK,KAAL,CAAW,KAAX,EAAkB;AACzC,SAAK,oBAAL,CAA0B,UAAU,KAAV,CAA1B,CADyC;IAA1C;;;;+BAKY,OAAO;AACnB,QAAK,oBAAL,CAA0B,SAA1B,EAAqC,KAArC,EADmB;;;;iCAIL;AACd,UAAO,KAAK,IAAL,CAAU,KAAV,CADO;;;;2BAIN,OAAO;AACf,QAAK,YAAL,GAAoB,KAApB,GAA4B,KAA5B,CADe;AAEf,QAAK,oBAAL,CAA0B,KAA1B,EAFe;;;;uCAKK,UAAU,OAAO;AACrC,OAAM,SAAS,KAAK,IAAL,CAAU,MAAV,CADsB;;AAGrC,OAAI,aAAa,SAAb,EAAwB;AAC3B,WAAO,KAAP,GAAe,QAAf,CAD2B;IAA5B;;AAIA,OAAI,YAAY,OAAO,YAAP,CAPqB;;AASrC,OAAI,KAAK,KAAL,CAAW,OAAX,IAAsB,KAAK,KAAL,CAAW,IAAX,EAAiB;AAC1C,gBAAY,KAAK,GAAL,CAAS,KAAK,KAAL,CAAW,OAAX,GAAqB,UAArB,EAAiC,SAA1C,CAAZ,CAD0C;IAA3C;;AAIA,eAAY,KAAK,GAAL,CAAS,SAAT,EAAoB,UAApB,CAAZ,CAbqC;;AAerC,OAAI,KAAK,KAAL,CAAW,MAAX,KAAsB,SAAtB,EAAiC;AACpC,SAAK,QAAL,CAAc;AACb,aAAQ,SAAR;KADD,EADoC;;AAKpC,QAAI,KAAK,KAAL,CAAW,cAAX,EAA2B;AAC9B,UAAK,KAAL,CAAW,cAAX,CAA0B,KAA1B,EAAiC,SAAjC,EAD8B;KAA/B;IALD;;;;+BAWY,OAAO;AACnB,QAAK,oBAAL,CAA0B,MAAM,MAAN,CAAa,KAAb,CAA1B,CADmB;;AAGnB,OAAI,KAAK,KAAL,CAAW,cAAX,CAA0B,WAA1B,CAAJ,EAA4C;AAC3C,SAAK,KAAL,CAAW,SAAX,CAAqB,aAArB,CAAmC,MAAM,MAAN,CAAa,KAAb,CAAnC,CAD2C;IAA5C;;AAIA,OAAI,KAAK,KAAL,CAAW,QAAX,EAAqB;AACxB,SAAK,KAAL,CAAW,QAAX,CAAoB,KAApB,EADwB;IAAzB;;;;2BAKQ;AACR,OAAM,QAAQ,KAAK,KAAL,CADN;OAGP,WAOG,MAPH,SAHO;OAIP,QAMG,MANH,MAJO;OAKP,eAKG,MALH,aALO;OAMP,OAIG,MAJH,KANO;OAOP,YAGG,MAHH,UAPO;OAQP,YAEG,MAFH,UARO;;OASJ,kCACA,gFAVI;;AAYR,OAAM,YAAY,yBAAU,eAAV,EAA2B,SAA3B,CAAZ,CAZE;;AAcR,OAAI,MAAM,cAAN,CAAqB,WAArB,CAAJ,EAAuC;AACtC,WAAO,KAAP,GAAe,UAAU,KAAV,CADuB;IAAvC;;AAIA,UACC;;MAAK,WAAW,SAAX,EAAL;IACC,yDAAe,aAAY,QAAZ,EAAqB,UAAU,KAAK,YAAL,EAA9C,CADD;IAEC;AACC,UAAI,QAAJ;AACA,eAAS,IAAT;AACA,WAAM,IAAN;AACA,mBAAc,YAAd;AACA;AACA,YAAO,KAAP;AACA,gBAAW,SAAX;AACA,8BAAQ,QAAQ,MAAR,EAAe,UAAU,QAAV,EAAmB,YAAY,QAAZ,EAAqB,UAAU,UAAV,EAAqB,QAAQ,SAAR,gBAA4B,SAAhH;KARD,CAFD;IAYC,uDACK;AACJ,UAAI,OAAJ;AACA,WAAM,IAAN;AACA,eAAU,QAAV;AACA,eAAU,KAAK,YAAL;AACV,gBAAU,wBAAV;AACA,YAAS,EAAC,QAAQ,WAAW,SAAX,GAAuB,SAAvB,EAAiC,QAAQ,KAAK,KAAL,CAAW,MAAX,EAAkB,QAAQ,MAAR,EAA7E;MAPD,CAZD;IADD,CAlBQ;;;;QAvEJ;EAAyB,gBAAM,SAAN;;AAkH9B;;AAED,iBAAiB,SAAjB,GAA6B;AAC5B,eAAc,iBAAU,GAAV;AACd,YAAW,iBAAU,MAAV;AACX,QAAO,iBAAU,MAAV;AACP,YAAW,iBAAU,MAAV;;AAEX,OAAM,iBAAU,MAAV;AACN,UAAS,iBAAU,MAAV;;AAET,WAAU,iBAAU,IAAV;;AAEV,WAAU,iBAAU,IAAV;AACV,iBAAgB,iBAAU,IAAV;CAZjB;;AAeA,iBAAiB,YAAjB,GAAgC;AAC/B,OAAM,GAAN;CADD;;kBAIe","file":"EnhanceTextField.js","sourcesContent":["import React, {PropTypes} from 'react';\nimport KlassName from 'teapan/klassName';\nimport EventListener from '../../helper/EventListener';\n\nconst rowsHeight = 30;\n\nclass EnhanceTextField extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\theight: props.rows * rowsHeight,\n\t\t};\n\t\tthis.handleChange = this.handleChange.bind(this);\n\t\tthis.handleResize = this.handleResize.bind(this);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.syncHeightWithShadow();\n\t}\n\n\tcomponentWillReceiveProps(nextProps) {\n\t\tif (nextProps.value !== this.props.value) {\n\t\t\tthis.syncHeightWithShadow(nextProps.value);\n\t\t}\n\t}\n\n\thandleResize(event) {\n\t\tthis.syncHeightWithShadow(undefined, event);\n\t}\n\n\tgetInputNode() {\n\t\treturn this.refs.input;\n\t}\n\n\tsetValue(value) {\n\t\tthis.getInputNode().value = value;\n\t\tthis.syncHeightWithShadow(value);\n\t}\n\n\tsyncHeightWithShadow(newValue, event) {\n\t\tconst shadow = this.refs.shadow;\n\n\t\tif (newValue !== undefined) {\n\t\t\tshadow.value = newValue;\n\t\t}\n\n\t\tlet newHeight = shadow.scrollHeight;\n\n\t\tif (this.props.rowsMax >= this.props.rows) {\n\t\t\tnewHeight = Math.min(this.props.rowsMax * rowsHeight, newHeight);\n\t\t}\n\n\t\tnewHeight = Math.max(newHeight, rowsHeight);\n\n\t\tif (this.state.height !== newHeight) {\n\t\t\tthis.setState({\n\t\t\t\theight: newHeight,\n\t\t\t});\n\n\t\t\tif (this.props.onHeightChange) {\n\t\t\t\tthis.props.onHeightChange(event, newHeight);\n\t\t\t}\n\t\t}\n\t}\n\n\thandleChange(event) {\n\t\tthis.syncHeightWithShadow(event.target.value);\n\n\t\tif (this.props.hasOwnProperty('valueLink')) {\n\t\t\tthis.props.valueLink.requestChange(event.target.value);\n\t\t}\n\n\t\tif (this.props.onChange) {\n\t\t\tthis.props.onChange(event);\n\t\t}\n\t}\n\n\trender() {\n\t\tconst props = this.props;\n\t\tconst {\n\t\t\tdisabled,\n\t\t\tvalue,\n\t\t\tdefaultValue,\n\t\t\trows,\n\t\t\tvalueLink,\n\t\t\tclassName,\n\t\t\t...others\n\t\t} = props;\n\n\t\tconst klassName = KlassName('field-control', className);\n\n\t\tif (props.hasOwnProperty('valueLink')) {\n\t\t\tothers.value = valueLink.value;\n\t\t}\n\n\t\treturn (\n\t\t\t<div className={klassName}>\n\t\t\t\t<EventListener elementName=\"window\" onResize={this.handleResize} />\n\t\t\t\t<textarea\n\t\t\t\t\tref=\"shadow\"\n\t\t\t\t\ttabIndex=\"-1\"\n\t\t\t\t\trows={rows}\n\t\t\t\t\tdefaultValue={defaultValue}\n\t\t\t\t\treadOnly\n\t\t\t\t\tvalue={value}\n\t\t\t\t\tvalueLink={valueLink}\n\t\t\t\t\tstyle={{resize: 'none',overflow: 'hidden',visibility: 'hidden',position: 'absolute',height: 'initial',overflow: 'hidden'}}\n\t\t\t\t/>\n\t\t\t\t<textarea\n\t\t\t\t\t{...others}\n\t\t\t\t\tref=\"input\"\n\t\t\t\t\trows={rows}\n\t\t\t\t\tdisabled={disabled}\n\t\t\t\t\tonChange={this.handleChange}\n\t\t\t\t\tclassName='field-control-textarea'\n\t\t\t\t\tstyle = {{cursor: disabled ? 'default' : 'initial',height: this.state.height,resize: 'none'}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n};\n\nEnhanceTextField.propTypes = {\n\tdefaultValue: PropTypes.any,\n\tclassName: PropTypes.string,\n\tvalue: PropTypes.string,\n\tvalueLink: PropTypes.object,\n\n\trows: PropTypes.string,\n\trowsMax: PropTypes.string,\n\n\tdisabled: PropTypes.bool,\n\n\tonChange: PropTypes.func,\n\tonHeightChange: PropTypes.func,\n};\n\nEnhanceTextField.defaultProps = {\n\trows: '4',\n};\n\nexport default EnhanceTextField;"]}